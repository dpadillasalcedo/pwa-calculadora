/* ===================== SOFA-2 ===================== */
function calcSOFA(){
  let total = 0;
  document.querySelectorAll(".sofa").forEach(s => {
    total += Number(s.value);
  });

  document.getElementById("sofa_result").textContent =
    "SOFA-2 total: " + total;

  document.getElementById("sofa_mortality").textContent =
    total <= 1 ? "Mortalidad <10%" :
    total <= 5 ? "Mortalidad 10–20%" :
    total <= 9 ? "Mortalidad 20–40%" :
    total <= 12 ? "Mortalidad 40–50%" :
    "Mortalidad >50–90%";
}

function resetSOFA(){
  document.querySelectorAll(".sofa").forEach(s => s.selectedIndex = 0);
  sofa_result.textContent = "";
  sofa_mortality.textContent = "";
}

/* ===================== APACHE II ===================== */
function calcAPACHE(){
  const aps = +document.getElementById("apache_aps").value;
  const age = +document.getElementById("apache_age").value;
  const chronic = +document.getElementById("apache_chronic").value;

  const total = aps + age + chronic;

  document.getElementById("apache_result").textContent =
    "APACHE II total: " + total;

  document.getElementById("apache_mortality").textContent =
    total < 10 ? "Mortalidad ~5%" :
    total < 20 ? "Mortalidad ~15%" :
    total < 30 ? "Mortalidad ~35%" :
    "Mortalidad >50%";
}

function resetAPACHE(){
  apache_result.textContent = "";
  apache_mortality.textContent = "";
}

/* ===================== SAPS II ===================== */
function calcSAPS(){
  const score = +document.getElementById("saps_score").value;
  const logit = -7.7631 + (0.0737 * score);
  const mortality = (Math.exp(logit) / (1 + Math.exp(logit))) * 100;

  document.getElementById("saps_result").textContent =
    "SAPS II total: " + score;

  document.getElementById("saps_mortality").textContent =
    "Mortalidad estimada: " + mortality.toFixed(1) + "%";
}

function resetSAPS(){
  saps_result.textContent = "";
  saps_mortality.textContent = "";
}
