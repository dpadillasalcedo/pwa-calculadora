<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Farmacoteca UCI | Critical Care Tools</title>

  <meta name="description"
        content="Farmacoteca de uso en terapia intensiva. Uso educativo y de apoyo clínico." />
  <meta name="robots" content="index, follow" />

  <link rel="stylesheet" href="farmacoteca.css" />
</head>

<body class="app-root">

<main class="container">

  <!-- =========================
       CONTROLES
  ========================== -->
  <section class="card controls">
    <div class="controls-grid">
      <div>
        <label for="q">Buscar fármaco</label>
        <input id="q" type="search" placeholder="Ej: Noradrenalina…" />
      </div>

      <div>
        <label for="grupo">Grupo</label>
        <select id="grupo">
          <option value="all">Todos</option>
          <option value="vasopresores">Vasopresores</option>
        </select>
      </div>

      <div class="controls-actions">
        <button type="button" class="btn secondary" id="btnReset">Limpiar</button>
      </div>
    </div>
  </section>

  <!-- =========================
       FARMACO
  ========================== -->
  <article class="drug-card" id="noradrenalina" data-group="vasopresores">

    <header class="drug-head">
      <div>
        <h3>Noradrenalina</h3>
        <p class="muted small">Vasopresor</p>
      </div>
      <button type="button" class="btn toggle-sheet" aria-expanded="false">
        Ver ficha
      </button>
    </header>

    <section class="drug-sheet hidden">

      <div class="sheet-grid">
        <div>
          <span>Presentación</span>
          <b>4 mg / 4 ml</b>
        </div>

        <div>
          <span>Dilución habitual</span>
          <select class="dilucion">
            <option value="">Seleccionar</option>
            <option data-mcg-per-ml="16">4 mg en 250 ml</option>
            <option data-mcg-per-ml="80">8 mg en 100 ml</option>
            <option data-mcg-per-ml="80">20 mg en 250 ml</option>
          </select>
        </div>

        <div>
          <span>Concentración</span>
          <b class="concentracion">—</b>
        </div>

        <div>
          <span>Unidad</span>
          <b>mcg/kg/min</b>
        </div>
      </div>

      <div class="calc-block">
        <h4>Cálculo de dosis administrada</h4>

        <div class="calc-grid">
          <label>
            Peso (kg)
            <input type="number" class="peso" step="0.1" min="0">
          </label>

          <label>
            Velocidad (ml/h)
            <input type="number" class="velocidad" step="0.1" min="0">
          </label>

          <div class="calc-result">
            <span>Dosis administrada</span>
            <b class="resultado">—</b>
          </div>
        </div>
      </div>

      <div class="clinical-note">
        <b>Nota clínica:</b>
        interpretar según PAM objetivo, perfusión tisular.
      </div>

    </section>
  </article>


  <article class="drug-card" id="adrenalina" data-group="vasopresores">

  <header class="drug-head">
    <div>
      <h3>Adrenalina</h3>
      <p class="muted small">Vasopresor / Inotrópico</p>
    </div>
    <button type="button" class="btn toggle-sheet" aria-expanded="false">
      Ver ficha
    </button>
  </header>

  <section class="drug-sheet hidden">

    <div class="sheet-grid">
      <div>
        <span>Presentación</span>
        <b>1 mg / 1 ml</b>
      </div>

      <div>
        <span>Dilución habitual</span>
        <select class="dilucion">
          <option value="">Seleccionar</option>

          <!-- 4000 / 250 -->
          <option data-mcg-per-ml="16">
            4 mg en 250 ml (DX 5% / SF 0.9%)
          </option>

          <!-- 8000 / 250 -->
          <option data-mcg-per-ml="32">
            8 mg en 250 ml (DX 5% / SF 0.9%)
          </option>

          <!-- 1000 / 100 -->
          <option data-mcg-per-ml="10">
            1 mg en 100 ml (DX 5% / SF 0.9%)
          </option>
        </select>
      </div>

      <div>
        <span>Concentración</span>
        <b class="concentracion">—</b>
      </div>

      <div>
        <span>Unidad</span>
        <b>mcg/kg/min</b>
      </div>
    </div>

    <div class="calc-block">
      <h4>Cálculo de dosis administrada</h4>

      <div class="calc-grid">
        <label>
          Peso (kg)
          <input type="number" class="peso" step="0.1" min="0">
        </label>

        <label>
          Velocidad (ml/h)
          <input type="number" class="velocidad" step="0.1" min="0">
        </label>

        <div class="calc-result">
          <span>Dosis administrada</span>
          <b class="resultado">—</b>
        </div>
      </div>
    </div>

    <div class="clinical-note">
      <b>Nota clínica:</b>
      titular según respuesta hemodinámica, lactato y perfusión tisular.
    </div>

  </section>
</article>

  
  <article class="drug-card" id="vasopresina" data-group="vasopresores">

  <header class="drug-head">
    <div>
      <h3>Vasopresina</h3>
      <p class="muted small">Vasopresor</p>
    </div>
    <button type="button" class="btn toggle-sheet" aria-expanded="false">
      Ver ficha
    </button>
  </header>

  <section class="drug-sheet hidden">

    <div class="sheet-grid">
      <div>
        <span>Presentación</span>
        <b>20 UI / 1 ml</b>
      </div>

      <div>
        <span>Dilución habitual</span>
        <select class="dilucion vasopresina">
          <option value="">Seleccionar</option>

          <!-- 20 UI / 100 ml -->
          <option data-ui-per-ml="0.2">
            20 UI en 100 ml (SF 0.9%)
          </option>

          <!-- 20 UI / 50 ml -->
          <option data-ui-per-ml="0.4">
            20 UI en 50 ml (SF 0.9%)
          </option>

          <!-- 40 UI / 100 ml -->
          <option data-ui-per-ml="0.4">
            40 UI en 100 ml (SF 0.9%)
          </option>
        </select>
      </div>

      <div>
        <span>Concentración</span>
        <b class="concentracion">—</b>
      </div>

      <div>
        <span>Unidad</span>
        <b>UI/min</b>
      </div>
    </div>

    <div class="calc-block">
      <h4>Cálculo de dosis administrada</h4>

      <div class="calc-grid">
        <label>
          Velocidad (ml/h)
          <input type="number" class="velocidad" step="0.1" min="0">
        </label>

        <div class="calc-result">
          <span>Dosis administrada</span>
          <b class="resultado">—</b>
        </div>
      </div>
    </div>

    <div class="clinical-note">
      <b>Nota clínica:</b>
      dosis habitual 0.01–0.04 UI/min. No titular por peso.
    </div>

  </section>
</article>



</main>

<footer>
  <p>
    © 2026 Critical Care Tools · Uso educativo.
  </p>
</footer>

<!-- =========================
     JS: UI + CÁLCULO
========================== -->
<script>
  // Toggle ficha
  document.addEventListener("click", (e) => {
    const btn = e.target.closest(".toggle-sheet");
    if (!btn) return;

    const card = btn.closest(".drug-card");
    const sheet = card.querySelector(".drug-sheet");
    const open = !sheet.classList.contains("hidden");

    sheet.classList.toggle("hidden");
    btn.setAttribute("aria-expanded", String(!open));
    btn.textContent = open ? "Ver ficha" : "Ocultar ficha";
  });

  // =========================
  // CÁLCULO FARMACOLÓGICO
  // =========================
  function recalcular(card) {
    const sel = card.querySelector(".dilucion");
    const concEl = card.querySelector(".concentracion");
    const pesoEl = card.querySelector(".peso");
    const velEl = card.querySelector(".velocidad");
    const resEl = card.querySelector(".resultado");

    if (!sel || !concEl || !pesoEl || !velEl || !resEl) return;

    const opt = sel.options[sel.selectedIndex];
    const conc = parseFloat(opt?.dataset?.mcgPerMl);

    if (!Number.isFinite(conc)) {
      concEl.textContent = "—";
      resEl.textContent = "—";
      return;
    }

    concEl.textContent = `${conc.toFixed(1)} mcg/ml`;

    const peso = parseFloat(pesoEl.value);
    const vel = parseFloat(velEl.value);

    if (
      !Number.isFinite(peso) || peso <= 0 ||
      !Number.isFinite(vel) || vel <= 0
    ) {
      resEl.textContent = "—";
      return;
    }

    // mcg/kg/min = (ml/h × mcg/ml) / (kg × 60)
    const dosis = (vel * conc) / (peso * 60);
    resEl.textContent = `${dosis.toFixed(3)} mcg/kg/min`;
  }

  document.addEventListener("change", (e) => {
    if (!e.target.classList.contains("dilucion")) return;
    const card = e.target.closest(".drug-card");
    if (card) recalcular(card);
  });

  document.addEventListener("input", (e) => {
    if (
      e.target.classList.contains("peso") ||
      e.target.classList.contains("velocidad")
    ) {
      const card = e.target.closest(".drug-card");
      if (card) recalcular(card);
    }
  });
</script>

</body>
</html>
